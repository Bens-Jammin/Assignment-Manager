<!doctype html>

<html lang="en">
<head>
    <meta charset='UTF-8'/>
    <title>Assignment Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>

<body>
    <div class="topnav">
        <a class="active" href="#home">Assignment Info</a>
        <a href="{{ url_for('timetable') }}">Class Schedule</a>
        <a href="#contact">Contact</a>
        <a href="#about">About</a>
    </div> 


    <div class="tables-container">
        <div class='assignment-table-container'>
            <div class='save-button' >
                <button type="submit" id="saveButton">Save</button>
            </div>
            {{ assignments_table | safe }}
        </div>

        <div class="minor-table-container">
            <div class="grade-table-container">
                <p style="align-self: center"> GRADES </p>
                {{ grade_table | safe }}
            </div>    

            <div class="todo-table-container">
                <p style="align-self: center;"> TODO </p>
                {{ todo_table | safe }}
            </div>
        </div>
    </div>

    <!-- script for the save button -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function(){
            $("#saveButton").click(function(){
                
                const assignmentCells = document.getElementsByClassName('assignment-table');
                
                // Create an array to hold the data from each cell
                let assignmentsData = [];
                for (let cell of assignmentCells) { 
                     
                    // Push the text content of each cell to the array
                    assignmentsData.push(cell.textContent);
                }

                $.ajax({
                    url: "{{ url_for('save') }}",
                    type: "POST",
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    data: JSON.stringify({assignments: assignmentsData}), // Data to be sent to the server
                    contentType: "application/json", // This sets the content type of the request
                    dataType: "json",
                    success: function(response) {
                        console.log( JSON.stringify({assignments: assignmentsData}) )
                        // You can add code here to update the UI as needed.
                    },
                    error: function(xhr) {
                        // Handle error.
                        console.log(xhr.responseText);
                    }
                });
            });
        });
        </script>
        ```
    

</body>

</html>